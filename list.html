<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <title>List Client</title>
</head>

<body>
    <div class="container is-max-desktop">

        <div class="card" style="margin-top: 3rem;">
            <div class="card-content">

                <div class="field">
                    <div class="field has-addons">

                        <input id="inputClient" class="input is-small" type="text" placeholder="Text input">
                        <p class="control"><button class="button is-success is-small" onclick="addButtonListClient()">
                        <span>+</span></button></p>

                    </div>
                </div>

                <div id="clientList" class="field"></div>

            </div>
        </div>

    </div>

    <script>
        const inputClient = document.querySelector("#inputClient")
        const clientList = document.querySelector("#clientList")

        let myLocalStorage = [{
            id: 10,
            name: "Copasa"
        }, {
            id: 20,
            name: "RNP"
        }, {
            id: 30,
            name: "Via Varejo"
        }, ]

        function loadClientList() {
            myLocalStorage.forEach(element => {
                const buttonList = createButtonList(element.name, element.id)
                clientList.appendChild(buttonList)
            });
        }

        function removeLocalStorage(id) {
            myLocalStorage = myLocalStorage.filter(element => {
                if (element.id != id)
                    return element
            })
        }

        function addLocalStorage(name, id) {
            myLocalStorage.push({
                id: id,
                name: name
            })
        }

        loadClientList()

        function generateID() {
            return Math.round(Math.random() * 1000)
        }

        function createButton(name) {
            let btn = {}
            btn.p = document.createElement("p")
            btn.button = document.createElement("button")

            btn.getButton = () => {
                btn.button.innerHTML = name
                btn.p.classList.add("control")
                btn.button.classList.add("button")
                btn.p.appendChild(btn.button)
                return btn.p
            }

            return btn
        }

        function createButtonList(name, id) {
            const buttonClient = createButton(name)
            buttonClient.button.classList.add("is-small", "is-fullwidth")
            buttonClient.p.classList.add("is-expanded")

            const buttonRemove = createButton("-")
            buttonRemove.button.classList.add("is-small", "is-danger")
            buttonRemove.button.addEventListener("click", removeButtonListClient)
            buttonRemove.button.id = id

            const lineList = document.createElement("div")
            lineList.classList.add("field", "has-addons")
            lineList.style.marginBottom = "0.10rem"
            lineList.id = id

            lineList.appendChild(buttonClient.getButton())
            lineList.appendChild(buttonRemove.getButton())

            return lineList
        }

        function addButtonListClient() {
            let name = inputClient.value
            if (!name) return

            const id = generateID()
            const buttonList = createButtonList(name, id)
            clientList.appendChild(buttonList)
            addLocalStorage(name, id)
        }

        function removeButtonListClient() {
            event.preventDefault()
            const buttonList = document.getElementById(event.target.id)
            buttonList.remove()
            removeLocalStorage(event.target.id)
        }
    </script>


</body>

</html>